[["index.html", "A Minimal Book Example 1 Prerequisites", " A Minimal Book Example Yihui Xie 2020-11-24 1 Prerequisites This is a sample book written in Markdown. You can use anything that Pandocs Markdown supports, e.g., a math equation \\(a^2 + b^2 = c^2\\). The bookdown package can be installed from CRAN or Github: install.packages(&quot;bookdown&quot; &quot;clinicalfd&quot;) # or the development version # devtools::install_github(&quot;rstudio/bookdown&quot;) Remember each Rmd file contains one and only one chapter, and a chapter is defined by the first-level heading #. To compile this example to PDF, you need XeLaTeX. You are recommended to install TinyTeX (which includes XeLaTeX): https://yihui.org/tinytex/. "],["intro.html", "2 Introduction", " 2 Introduction You can label chapter and section titles using {#label} after them, e.g., we can reference Chapter 2. If you do not manually label them, there will be automatic labels anyway, e.g., Chapter 8. Figures and tables with captions will be placed in figure and table environments, respectively. What is R? * R is a free language and environment for statistical computing and graphics. You can perform a variety of tasks using R language. Some are as follows - Exploring and Manipulating Data Building and validating predictive models Applying machine learning and text mining algorithms Creating visual appealing graphs Connecting with Databases Building online dynamic reports or dashboards Send emails or push notification via R What is RStudio and its benefits over standard R? RStudio was built to make your life easy as a R programmer. It is available in open source for FREE. Unlike standard R, it supports various premium features such as intelligent code completion, syntax highlighting, structured R documentation, interactive debugging tool etc. Some Useful RStudio Shortcuts Press CTRL + Enter to submit code Press CTRL + SHIFT + C to comment/ uncomment code Press CTRL + SHIFT + N to create a new R script ###Basics of R Programming### Write your first equation in R Enter 5*3 in the RStudio code editor window and hit CTRL + ENTER in RStudio (or press F5 in standard R) # Write your first equation in R 5 * 3 ## [1] 15 The [1] tells you the resulting value is the first result The # at the beginning of a line signifies a comment Try Shift+Cntrl+c on Rstudio NOTE : ### has different meaning in R-Markdown syntax The operator &lt;- is equivalent to = sign, you can use either of the operators. NOTE: &lt;- is preferred to = in R as assignment operator setwd() function assigns a working directory setwd() is similar to Libname in SAS envirnoment getwd() function shows working directory R uses NA getwd() The table below summarizes the treatment variables and population flags that exist among different groups of analysis requirements: par(mar = c(4, 4, .1, .1)) plot(pressure, type = &#39;b&#39;, pch = 19) Figure 2.1: Here is a nice figure! Reference a figure by its code chunk label with the fig: prefix, e.g., see Figure 2.1. Similarly, you can reference tables generated from knitr::kable(), e.g., see Table 2.1. knitr::kable( head(iris, 20), caption = &#39;Here is a nice table!&#39;, booktabs = TRUE ) Table 2.1: Here is a nice table! Sepal.Length Sepal.Width Petal.Length Petal.Width Species 5.1 3.5 1.4 0.2 setosa 4.9 3.0 1.4 0.2 setosa 4.7 3.2 1.3 0.2 setosa 4.6 3.1 1.5 0.2 setosa 5.0 3.6 1.4 0.2 setosa 5.4 3.9 1.7 0.4 setosa 4.6 3.4 1.4 0.3 setosa 5.0 3.4 1.5 0.2 setosa 4.4 2.9 1.4 0.2 setosa 4.9 3.1 1.5 0.1 setosa 5.4 3.7 1.5 0.2 setosa 4.8 3.4 1.6 0.2 setosa 4.8 3.0 1.4 0.1 setosa 4.3 3.0 1.1 0.1 setosa 5.8 4.0 1.2 0.2 setosa 5.7 4.4 1.5 0.4 setosa 5.4 3.9 1.3 0.4 setosa 5.1 3.5 1.4 0.3 setosa 5.7 3.8 1.7 0.3 setosa 5.1 3.8 1.5 0.3 setosa adsl &lt;- clinicalfd::adsl head(adsl) ## studyid usubjid subjid siteid sitegr1 arm ## 1 CDISCPILOT01 01-701-1015 1015 701 701 Placebo ## 2 CDISCPILOT01 01-701-1023 1023 701 701 Placebo ## 3 CDISCPILOT01 01-701-1028 1028 701 701 Xanomeline High Dose ## 4 CDISCPILOT01 01-701-1033 1033 701 701 Xanomeline Low Dose ## 5 CDISCPILOT01 01-701-1034 1034 701 701 Xanomeline High Dose ## 6 CDISCPILOT01 01-701-1047 1047 701 701 Placebo ## trt01p trt01pn trt01a trt01an trtsdt ## 1 Placebo 0 Placebo 0 2014-01-02 ## 2 Placebo 0 Placebo 0 2012-08-05 ## 3 Xanomeline High Dose 81 Xanomeline High Dose 81 2013-07-19 ## 4 Xanomeline Low Dose 54 Xanomeline Low Dose 54 2014-03-18 ## 5 Xanomeline High Dose 81 Xanomeline High Dose 81 2014-07-01 ## 6 Placebo 0 Placebo 0 2013-02-12 ## trtedt trtdur avgdd cumdose age agegr1 agegr1n ageu race racen sex ## 1 2014-07-02 182 0.0 0 63 &lt;65 1 YEARS WHITE 1 F ## 2 2012-09-01 28 0.0 0 64 &lt;65 1 YEARS WHITE 1 M ## 3 2014-01-14 180 77.7 13986 71 65-80 2 YEARS WHITE 1 M ## 4 2014-03-31 14 54.0 756 74 65-80 2 YEARS WHITE 1 M ## 5 2014-12-30 183 76.9 14067 77 65-80 2 YEARS WHITE 1 F ## 6 2013-03-09 26 0.0 0 85 &gt;80 3 YEARS WHITE 1 F ## ethnic saffl ittfl efffl comp8fl comp16fl comp24fl disconfl ## 1 HISPANIC OR LATINO Y Y Y Y Y Y ## 2 HISPANIC OR LATINO Y Y Y N N N Y ## 3 NOT HISPANIC OR LATINO Y Y Y Y Y Y ## 4 NOT HISPANIC OR LATINO Y Y Y N N N Y ## 5 NOT HISPANIC OR LATINO Y Y Y Y Y Y ## 6 NOT HISPANIC OR LATINO Y Y Y N N N Y ## dsraefl dthfl bmibl bmiblgr1 heightbl weightbl educlvl disonsdt durdis ## 1 25.1 25-&lt;30 147.3 54.4 16 2010-04-30 43.9 ## 2 Y 30.4 &gt;=30 162.6 80.3 14 2006-03-11 76.4 ## 3 31.4 &gt;=30 177.8 99.3 16 2009-12-16 42.8 ## 4 28.8 25-&lt;30 175.3 88.5 12 2009-08-02 55.3 ## 5 26.1 25-&lt;30 154.9 62.6 9 2011-09-29 32.9 ## 6 Y 30.4 &gt;=30 148.6 67.1 8 2009-07-26 42.0 ## durdsgr1 visit1dt rfstdtc rfendtc visnumen rfendt ## 1 &gt;=12 2013-12-26 2014-01-02 2014-07-02 12 2014-07-02 ## 2 &gt;=12 2012-07-22 2012-08-05 2012-09-02 5 2012-09-02 ## 3 &gt;=12 2013-07-11 2013-07-19 2014-01-14 12 2014-01-14 ## 4 &gt;=12 2014-03-10 2014-03-18 2014-04-14 5 2014-04-14 ## 5 &gt;=12 2014-06-24 2014-07-01 2014-12-30 12 2014-12-30 ## 6 &gt;=12 2013-01-22 2013-02-12 2013-03-29 6 2013-03-29 ## dcdecod dcreascd mmsetot ## 1 COMPLETED Completed 23 ## 2 ADVERSE EVENT Adverse Event 23 ## 3 COMPLETED Completed 23 ## 4 STUDY TERMINATED BY SPONSOR Sponsor Decision 23 ## 5 COMPLETED Completed 21 ## 6 ADVERSE EVENT Adverse Event 23 "],["study-cdisc-pilot01-guide.html", "3 Study CDISC Pilot01 Guide", " 3 Study CDISC Pilot01 Guide Note on Input Data Sources The analysis files for this study were derived from the submitted SDTM files. SDTM files were prepared from CRF data according to version 3.1.2 of the SDTM IG (with amendment 1). No non-CRF or non-SDTM data were used to create the ADaM data. The datasets include only subjects who were enrolled in the study. Subjects who failed screening criteria were not included in analysis datasets. Where to Find Key Data Demographics and Populations The ADSL (Subject Level Analysis Data) dataset contains all subject-level variables for demographics, subject characteristics, and population flags. Safety Key safety data are found in the datasets ADAE (Adverse Events Analysis Data), ADLBC (Laboratory Results Chemistry Analysis Data), ADLBH (Laboratory Results Hematology Analysis Data), ADLBHY (Laboratory Results Hys Rule Analysis Data), ADVS (Vital Signs Analysis Dataset). ADTTE is specifically for safety analyses of the time to the first dermatologic AE. Dermatologic AEs are considered an adverse event of special interest. Efficacy Study CDISCPilot01 has two primary endpoints, the Alzheimers Disease Assessment Scale - Cognitive Subscale, total of 11 items [ADAS-Cog (11)] at Week 24 and the Video-referenced Clinicians Interview-based Impression of Change (CIBIC+) at Week 24. All ADAS-Cog data, including the first primary endpoint, can be found in the dataset ADQSADAS. All CIBIC+ data, including the second primary endpoint, can be found in the dataset ADQSCIBC. Mean Revised Neuropsychiatric Inventory (NPI-X) data are considered secondary. These data can be found in the dataset ADQSNPIX. Protocol Deviations Protocol deviations were not reported in the source database and have not been incorporated into the SDTM data. As a result, such data do not exist among the analysis data. Core Variables The following core variables were merged from ADSL into all analysis datasets: STUDYID, SITEID, USUBJID, TRTSDT, TRTEDT, AGE, AGEGR1, AGEGR1N, SEX, RACE, and RACEN. The table below summarizes the treatment variables and population flags that exist among different groups of analysis requirements: Dataset(s) Treatment Variables Population Flags ADSL TRT01P, TRT01PN, TRT01A,TRT01AN SAFFL, DSRAEFL,ITTFL, EFFFL,COMP24FL ADAE TRTA, TRTAN SAFFL ADLBH,ADLBC, ADLBHY TRTP, TRTPN, TRTA,TRTAN SAFFL,COMP24FL,DSRAEFL ADVS TRTP, TRTPN, TRTA,TRTAN SAFFL ADTTE TRTP, TRTA, TRTAN SAFFL ADQSADAS, ADQSNPIX, ADQSCIBC TRTP, TRTPN ITTFL, EFFFL,COMP24FL Treatment variable values are based on the numeric dose level (i.e., 0, 54, 81) to avoid the need for a separate variable that contains the treatment dose. "],["overview-of-analysis-datasets.html", "4 Overview of Analysis Datasets 4.1 ADAE  Adverse Events Analysis Data 4.2 ADLBHY  Laboratory Results Hys Rule Analysis Data 4.3 ADQSADAS  ADAS-COG Data 4.4 ADQSCIBC  CIBC Data 4.5 ADQSNPIX  NPI-X Item Analysis Data", " 4 Overview of Analysis Datasets Overview of Analysis Datasets Important information regarding specific analysis data sets can be found below. For full details of all analysis data sets, including key analysis results 4.1 ADAE  Adverse Events Analysis Data ADAE contains one record per reported event per subject. Subjects who did not report any Adverse Events are not represented in this dataset. The data reference for ADAE is the SDTM AE (Adverse Events) domain and there is a 1-1 correspondence between records in the source and this analysis dataset. These records can be linked uniquely by STUDYID, USUBJID, and AESEQ. As with the SDTM AE data set, all MedDRA code variables (i.e. those variables that end in CD) have missing values and dummy terms have been applied to the MedDRA High Level Term (HLT) and High Level Group Term (HLGT). This is due to the proprietary nature of the MedDRA dictionary and the fact that the data with this project will be made available to the public. In a standard submission, these codes and terms should be non-missing and properly populated. Events of particular interest (dermatologic) are captured in the customized query variable (CQ01NAM) in this dataset.Since ADAE is a source for ADTTE, the first chronological occurrence based on the start dates (and sequence numbers) of the treatment emergent dermatological events are flagged (AOCC01FL) to facilitate traceability between these two analysis datasets. ADAE also contains additional Occurrence Flags to facilitate traceability, reviewability, and easy of reporting between the analysis dataset and the unique counts in the summary tables. For treatment emergent adverse events refer to define.xml documentation for the following variables: AOCCFL, AOCCSFL, and AOCCPFL for summarization at the subject,System Organ Class, and Preferred Term levels, respectively. Similarly, refer to the define.xml documentation for AOCC02FL, AOCC03FL, and AOCC04FL for summarization of serious adverse events at the subject, System Organ Class, and Preferred Term levels. The three deaths reported during the conduct of this study are captured in the Results in Death Flag (AESDTH=Y) and Outcome of Adverse Event (AEOUT=FATAL). The Start Date of the Adverse Event in ADAE is imputed to the first of the month if the day is missing. The Study Day of Event Start (ASTDY) and the Treatment Emergent Analysis Flag (TRTEMFL) are derived based on this imputation and may differ from their corresponding SDTM AE/SUPPAE variables Study Day of Start of Adverse Event (AESTDY) and Treatment Emergent Flag (AETRTEM). ADLBC&amp;BH  Laboratory Results Chemistry/Hematology Analysis Data** ADLBC and ADLBH contain one record per lab analysis parameter, per time point, per subject.** ADLBC contains lab chemistry parameters and ADLBH contains hematology parameters and these data are derived from the SDTM LB (Laboratory Tests) domain. Two sets of lab parameters exist in ADLBC/ADLBH. One set contains the standardized lab value from the LB domain and the second set contains change from previous visit relative to normal range values. In some of the summaries the derived end-of-treatment visit (AVISITN=99) is also presented. 4.2 ADLBHY  Laboratory Results Hys Rule Analysis Data ADLBHY contains one record per lab test code per sample, per subject for the Hys Law based analysis parameters. ADLBHY is derived from the ADLBC (Laboratory Results Chemistry Analysis Data) analysis dataset. It contains derived parameters based on Hys law. 4.3 ADQSADAS  ADAS-COG Data ADQSADAS contains analysis data from the ADAS-Cog questionnaire, one of the primary efficacy endpoints. It contains one record per subject per parameter (ADAS-Cog questionnaire item) per VISIT. Visits are placed into analysis visits (represented by AVISIT and AVISITN) based on the date of the visit and the visit windows. If multiple visits fall into the same visit window, then the one closest to the target date is chosen for analysis. Records where ANL01FL=Y are the ones that were used for analysis. The last observation carried forward (LOCF) algorithm only considered records used for analysis as candidates to carry forward. Records where DTYPE=LOCF signify those where AVAL was imputed using the LOCF algorithm. Source data can be traced back to the SDTM.QS domain using USUBJID and QSSEQ.Details on how to derive the primary efficacy result based on ADAS-Cog data can be found in the analysis results metadata in the define.xml. 4.4 ADQSCIBC  CIBC Data ADQSCIBC contains analysis data from the from CIBIC+ questionnaire, one of the primary efficacy endpoints. It contains one record per subject per VISIT. Note that for all records, PARAM=CIBIC Score. Visits are placed into analysis visits (represented by AVISIT and AVISITN) based on the date of the visit and the visit windows. If multiple visits fall into the same visit window, then the one closest to the target date is chosen for analysis. Records where ANL01FL=Y are the ones that were used for analysis. The last observation carried forward (LOCF) algorithm only considered records used for analysis as candidates to carry forward. Records where DTYPE=LOCF signify those where AVAL was imputed using the LOCF algorithm. Source data can be traced back to the SDTM.QS domain using USUBJID and QSSEQ. Details on how to derive the primary efficacy result based on CIBIC+ data can be found in the analysis results metadata in the define.xml. 4.5 ADQSNPIX  NPI-X Item Analysis Data ADQSNPIX contains one record per subject per parameter (NPI-X questionnaire item, total score, and mean total score from Week 4 through Week 24) per analysis visit (AVISIT). The analysis visits (represented by AVISIT and AVISITN) are derived from days between assessment date and randomization date and based on the visit windows that were specified in the statistical analysis plan (SAP). If multiple assessments fall into the same visit window, then the one closest to the target day is chosen for analysis. Records where analysis flag (ANL01FL) = Y are the ones that were used for analysis. The last observation carried forward (LOCF) algorithm was not used for these data. Source data can be traced back to the SDTM.QS domain using USUBJID and QSSEQ. All the NPI-X parameters, except for the mean total score from Week 4 through Week 24 (NPTOTMN), are from SDTM.QS domain. The value of parameter, NPTOTMN, contains the mean total score for each patient who had any assessments from Week 4 through Week 24. The baseline value of the parameter, NPTOTMN, is the same as the baseline value of total score. The baseline value is a covariate in the analysis of covariance (ANCOVA) model. "],["adam-datasets-for-study-cdisc-pilot-01.html", "5 ADaM Datasets for Study CDISC PILOT 01", " 5 ADaM Datasets for Study CDISC PILOT 01 Adam Datasets List Dataset Description Class Structure Keys Location ADSL Subject-Level Analysis ADSL one record per subject USUBJID adsl.xpt ADAE Adverse Events Analysis Dataset ADAE one record per subject per adverse event USUBJID, AETERM, ASTDT, AESEQ adae.xpt ADLBC Analysis Dataset Lab Blood Chemistry BDS one record per subject per parameter per analysis visit USUBJID, PARAMCD, AVISIT, LBSEQ adlbc.xpt ADLBH Analysis Dataset Lab Hematology BDS one record per subject per parameter per analysis visit USUBJID, PARAMCD, AVISIT, LBSEQ adlbh.xpt ADLBHY Analysis Dataset Lab Hys Law BDS one record per subject per parameter per analysis visit USUBJID, PARAMCD, AVISIT, LBSEQ adlbhy.xpt ADQSADAS ADAS-Cog Analysis BDS one record per subject per parameter per analysis visit per analysis date USUBJID, PARAMCD, AVISIT, ADT adqsadas.xpt ADQSCIBC CIBIC+ Analysis BDS one record per subject per parameter per analysis visit per analysis date USUBJID, PARAMCD, AVISIT, ADT adqscibc.xpt ADQSNPIX NPI-X Item Analysis Data BDS one record per subject per parameter per analysis visit per analysis date USUBJID, PARAMCD, AVISIT, ADT adqsnpix.xpt ADTTE AE Time To 1st Derm. Event Analysis BDS one record per subject per parameter USUBJID, PARAMCD adtte.xpt ADVS Vital Signs Analysis Dataset BDS one record per subject per parameter per analysis visit per analysis timepoint USUBJID, PARAMCD, AVISIT, ATPT advs.xpt "],["subject-level-analysis-adsl.html", "6 Subject-Level Analysis (ADSL)", " 6 Subject-Level Analysis (ADSL) NOTE: Derived = 1 is direct copy from SDTM.DM or Other SDTM dataset , while Derived = 2 needs further imputation. Variable Label Type Code List / Controlled Terms Derived Source/Derivation/Comments STUDYID Study Identifier text 1 DM.STUDYID USUBJID Unique Subject Identifier text 1 DM.USUBJID SUBJID Subject Identifier for the Study text 1 DM.SUBJID SITEID Study Site Identifier text 1 DM.SITEID ARM Description of Planned Arm text ARM 1 DM.ARM TRT01P Planned Treatment for Period 01 text ARM 1 DM.ARM TRT01PN Planned Treatment for Period 01 (N) integer ARMN 1 Numeric code for TRT01P which corresponds to the randomized dose TRT01A Actual Treatment for Period 01 text ARM 1 TRT01A=TRT01P, i.e., no difference between actual and randomized treatment in this study. TRT01AN Actual Treatment for Period 01 (N) integer ARMN 1 Numeric code for TRT01A which corresponds to the randomized dose AGE Age integer 1 DM.AGE AGEU Age Units text AGEU 1 DM.AGEU RACE Race text RACE 1 DM.RACE RACEN Race (N) integer RACEN 1 Numeric code for RACE SEX Sex text SEX 1 DM.SEX ETHNIC Ethnicity text ETHNIC 1 DM.ETHNIC DTHFL Subject Died? text Y_BLANK 1 DM.DTHFL RFSTDTC Subject Reference Start Date/Time datetime ISO8601 1 DM.RFSTDTC RFENDTC Subject Reference End Date/Time datetime ISO8601 1 DM.RFENDTC SITEGR1 Pooled Site Group 1 text 2 refer to SAP, Section 7.1 - if not pooled then SITEGR1=SITEID. If pooled, SITEGR1 will be 900 TRTSDT Date of First Exposure to Treatment integer 2 SV.SVSTDTC when SV.VISITNUM=3, converted to SAS date TRTEDT Date of Last Exposure to Treatment integer 3 The date of final dose (from the CRF) is EX.EXENDTC on the subjects last EX record. If the date of final dose is missing for the subject and the subject discontinued after visit 3, use the date of discontinuation as the date of last dose. Convert the date to a SAS date. TRTDUR Duration of Treatment (days) integer 2 TRTEDT-TRTSDT+1 AVGDD Avg Daily Dose (as planned) float 2 CUMDOSE/TRTDUR CUMDOSE Cumulative Dose (as planned) float 3 For ARMN=0 or 1: CUMDOSE=TRT01PN*TRTDUR.  For ARMN=2: CUMDOSE will be based on 54mg per day for the # of days subj was in 1st dosing interval (i.e., visit4date-TRTSTDT+1 if 1st interval completed, TRTEDT-TRTSTDT+1 if subj discontinued &lt;=visit 4 and &gt; visit 3), 81mg per day for the # of days subj was in 2nd dosing interval (i.e., visit12date-visit4date if 2nd interval completed, TRTEDT-visit4date if subj discontinued &lt;= visit 12 and &gt; visit 4), and 54mg per day for the # of days subj was in 3rd dosing interval (i.e., TRTEDT - visit12date if subj continued after visit 12). AGEGR1 Pooled Age Group 1 text AGEGR1 2 Character variable derived from ADSL.AGEGR1N AGEGR1N Pooled Age Group 1 (N) integer AGEGR1N 2 AGEGR1 = 1 if AGE &lt;65. AGEGR1 = 2 if AGE 65-80. AGEGR1 = 3 if AGE &gt;80. SAFFL Safety Population Flag text YN 2 Y if ITTFL=Y and TRTSDT ne missing. N otherwise ITTFL Intent-To-Treat Population Flag text YN 2 Y if ARMCD ne  . N otherwise EFFFL Efficacy Population Flag text YN 3 Y if SAFFL=Y AND subject has at least one record in QS for ADAS-Cog with VISITNUM&gt;3 AND at least one record in QS for CIBIC+ with VISITNUM&gt;3, N otherwise COMP8FL Completers of Week 8 Population Flag text YN 2 Y if subject has a SV.VISITNUM=8 and ENDDT &gt;= date of visit 8, N otherwise COMP16FL Completers of Week 16 Population Flag text YN 2 Y if subject has a SV.VISITNUM=10 and ENDDT&gt;=date of visit 10, N otherwise COMP24FL Completers of Week 24 Population Flag text YN 2 Y if subject has a SV.VISITNUM=12 and ENDDT&gt;= date of visit 12 , N otherwise DISCONFL Did the Subject Discontinue the Study? text Y_BLANK 2 Y if DCREASCD ^= Completed. Null otherwise DSRAEFL Discontinued due to AE? text Y_BLANK 2 Y if DCREASCD=Adverse Event. Null otherwise BMIBL Baseline BMI (kg/m^2) float 2 WEIGHTBL / ((HEIGHTBL*100)**2) BMIBLGR1 Pooled Baseline BMI Group 1 text BMICAT 2 BMIBLGR1=Normal if . &lt; BMIBL &lt;25. BMIBLGR1=Overweight if 25 &lt;=BMIBL &lt;30. BMIBLGR1=Obese if BMIBL &gt;=30 HEIGHTBL Baseline Height (cm) float 2 VSSTRESN when VS.VSTESTCD=HEIGHT and VS.VISITNUM=1 WEIGHTBL Baseline Weight (kg) float 2 VSSTRESN when VS.VSTESTCD=WEIGHT and VS.VISITNUM=3 EDUCLVL Years of Education integer 2 SC.SCSTRESN where SC.SCTESTCD=YEARSEDU DISONSDT Date of Onset of Disease integer 2 MH.MHSTDTC where MHCAT=PRIMARY DIAGNOSIS converted to SAS date DURDIS Duration of Disease (Months) float 2 number of months between VISIT1DT and DISONSET DURDSGR1 Pooled Disease Duration Group 1 text DURDISC 2 grouping DURDIS values as &lt;12 and &gt;=12 VISIT1DT Date of Visit 1 integer 2 SV.SVSTDTC when SV.VISITNUM=1, converted to SAS date VISNUMEN End of Trt Visit (Vis 12 or Early Term.) integer 3 if DS.VISITNUM=13 where DSTERM=PROTCOL COMPLETED then VISNUMEN=12, otherwise VISNUMEN=DS.VISITNUM where DSTERM=PROTCOL COMPLETED RFENDT Date of Discontinuation/Completion integer 2 RFENDTC converted to SAS date DCDECOD Standardized Disposition Term text DISCCD 3 DS.DSDECOD where DSCAT=DISPOSITION EVENT DCREASCD Reason for Discontinuation text DISCREAS 2 Grouping of DCDECOD values to support summarizing study completion status and reason for discontinuation MMSETOT MMSE Total integer 2 sum of QS.QSORRES values for the subject "],["Variable.html", "7 Adsl derivations Derived = 1 level 7.1 Overview 7.2 Your Turn Lets start programming 7.3 Adsl Derivation Code part-1", " 7 Adsl derivations Derived = 1 level List of Variables Derived = 1 Variable Label Source/Derivation/Comments R Dplyr Snippet STUDYID Study Identifier DM.STUDYID select ( dm , studyid) USUBJID Unique Subject Identifier DM.USUBJID select ( dm , usubjid) SUBJID Subject Identifier for the Study DM.SUBJID select ( dm , subjid) SITEID Study Site Identifier DM.SITEID select ( dm , siteid) ARM Description of Planned Arm DM.ARM select ( dm , arm) TRT01P Planned Treatment for Period 01 DM.ARM select ( dm , arm) TRT01A Actual Treatment for Period 01 TRT01A=TRT01P, i.e., no difference between actual and randomized treatment in this study. mutate ( dm , TRT01A= ARM) TRT01AN Actual Treatment for Period 01 (N) Numeric code for TRT01A which corresponds to the randomized dose mutate( trt01pn =ifelse( (arm %in% \"Placebo\" ) , 0 , ifelse( (arm %in% Xanomeline Low Dose\" ) , 54, ifelse( (arm %in% \"Xanomeline High Dose\" ) , 81 , NA))) AGE Age DM.AGE select ( dm , age) RACE Race DM.RACE select ( dm , race) RACEN Race (N) Numeric code for RACE case_when( race %in% \"WHITE\" ~ 1 , race %in% \"BLACK OR AFRICAN AMERICAN\" ~ 2 , race %in% \"AMERICAN INDIAN OR ALASKA NATIVE\" ~ 6 , race %in% \"ASIAN\" ~ 7 ) SEX Sex DM.SEX select(dm,sex) ETHNIC Ethnicity DM.ETHNIC select(dm,ethnic) DTHFL Subject Died? DM.DTHFL select(dm,dthfl) RFSTDTC Subject Reference Start Date/Time DM.RFSTDTC select(dm,rfstdtc) RFENDTC Subject Reference End Date/Time DM.RFENDTC select(dm,rfendtc) 7.1 Overview 7.1.0.1 Important Functions dplyr is a grammar of data manipulation, providing a consistent set of verbs that help you solve the most common data manipulation challenges: mutate() adds new variables that are functions of existing variables select() picks variables based on their names. filter() picks cases based on their values. summarise() reduces multiple values down to a single summary. arrange() changes the ordering of the rows. 7.2 Your Turn **List out various Character and Numeric Dplyr functions** [Learn to use R Dplyr Package] List out all the functions used Filter Select case_when if_else() as.character mutate inner_join as.Date(as.character(svstdtc) ) as.Date as.Date.numeric Lets start programming Initialize all the Librarys needed for the project #intilizing the Dplyr library library(tidyverse) ## -- Attaching packages ------------- tidyverse 1.3.0 -- ## v ggplot2 3.3.2 v purrr 0.3.4 ## v tibble 3.0.3 v dplyr 1.0.2 ## v tidyr 1.1.2 v stringr 1.4.0 ## v readr 1.3.1 v forcats 0.5.0 ## -- Conflicts ---------------- tidyverse_conflicts() -- ## x dplyr::filter() masks stats::filter() ## x dplyr::lag() masks stats::lag() library(clinicalfd) Bring in the datasets needed # dm &lt;- clinicalfd::dm # names(clinicalfd::dm ) dm &lt;- clinicalfd::dm dm &lt;- dplyr :: filter(dm ,arm !=&quot;Screen Failure&quot; ) adsl_deri01 &lt;- dplyr::select ( dm , usubjid , siteid,arm) # Select #dm_01 &lt;- mutate (dm_01 , usubjid = as.character(usubjid) ) adsl_deri01 &lt;- dplyr::mutate( adsl_deri01 , TRT01P = arm) #Use of Mutate function to create new variable# 7.3 Adsl Derivation Code part-1 adsl_deri01 &lt;- dm %&gt;% filter (actarmcd !=&quot;Scrnfail&quot;) %&gt;% mutate(sitegr1 = siteid , trt01p = arm , trt01a = arm , usubjid = as.character(usubjid), trt01pn = ifelse( (arm %in% &quot;Placebo&quot; ) , 0 , ifelse( (arm %in% &quot;Xanomeline Low Dose&quot; ) , 54, ifelse( (arm %in% &quot;Xanomeline High Dose&quot; ) , 81 , NA))) , trt01an = trt01pn , ittfl = ifelse (trt01pn %in% c(0,54,81) , &quot;Y&quot; , &quot;N&quot; ), agegr1 = case_when( age &lt; 65 ~ &quot;&lt;65&quot; , (65 &lt;= age &amp; age &lt;= 80 ) ~ &quot;65-80&quot; , (age &gt; 80 ) ~ &quot;&gt;80&quot; ), agegr1n = case_when( age &lt; 65 ~ 1 , (65 &lt;= age &amp; age &lt;= 80 ) ~ 2 , (age &gt; 80 ) ~ 3 ), race = case_when( race %in% &quot;WHITE&quot; ~ &quot;WHITE&quot; , race %in% &quot;BLACK OR AFRICAN AMERICAN&quot; ~ &quot;BLACK OR AFRICAN AMERICAN&quot; , race %in% &quot;AMERICAN INDIAN OR ALASKA NATIVE&quot; ~ &quot;AMERICAN INDIAN OR ALASKA NATIVE&quot; , race %in% &quot;ASIAN&quot; ~ &quot;ASIAN&quot; ) , racen = case_when( race %in% &quot;WHITE&quot; ~ 1 , race %in% &quot;BLACK OR AFRICAN AMERICAN&quot; ~ 2 , race %in% &quot;AMERICAN INDIAN OR ALASKA NATIVE&quot; ~ 6 , race %in% &quot;ASIAN&quot; ~ 7 ), sex = case_when(sex %in% &quot;F&quot; ~ &quot;Female&quot; , sex %in% &quot;M&quot; ~ &quot;Male&quot; , sex %in% &quot;U&quot; ~ &quot;Unknown&quot; ) , ethnic = case_when(ethnic %in% &quot;NOT HISPANIC OR LATINO&quot; ~ &quot;NOT HISPANIC OR LATINO&quot; , ethnic %in% &quot;HISPANIC OR LATINO&quot; ~ &quot;HISPANIC OR LATINO&quot; , ethnic %in% &quot;U&quot; ~ &quot;Unknown&quot; ) ) Date of First Exposure to Treatment SV.SVSTDTC when SV.VISITNUM=3, converted to SAS date 7.3.1 Date of First Exposure to Treatment (TRTSDT) sv_visit3 &lt;- clinicalfd::sv sv_visit3 &lt;- sv_visit3 %&gt;% filter(visitnum == 3) %&gt;% mutate(usubjid = as.character(usubjid) , trtsdt = as.Date(as.character(svstdtc)) ) %&gt;% select (usubjid , svstdtc , trtsdt ) sv_visit3 ## usubjid svstdtc trtsdt ## 1 01-701-1015 2014-01-02 2014-01-02 ## 2 01-701-1023 2012-08-05 2012-08-05 ## 3 01-701-1028 2013-07-19 2013-07-19 ## 4 01-701-1033 2014-03-18 2014-03-18 ## 5 01-701-1034 2014-07-01 2014-07-01 ## 6 01-701-1047 2013-02-12 2013-02-12 ## 7 01-701-1097 2014-01-01 2014-01-01 ## 8 01-701-1111 2012-09-07 2012-09-07 ## 9 01-701-1115 2012-11-30 2012-11-30 ## 10 01-701-1118 2014-03-12 2014-03-12 ## 11 01-701-1130 2014-02-15 2014-02-15 ## 12 01-701-1133 2012-10-28 2012-10-28 ## 13 01-701-1146 2013-05-20 2013-05-20 ## 14 01-701-1148 2013-08-23 2013-08-23 ## 15 01-701-1153 2013-09-23 2013-09-23 ## 16 01-701-1180 2013-02-12 2013-02-12 ## 17 01-701-1181 2013-12-05 2013-12-05 ## 18 01-701-1188 2013-02-15 2013-02-15 ## 19 01-701-1192 2012-07-22 2012-07-22 ## 20 01-701-1203 2013-02-02 2013-02-02 ## 21 01-701-1211 2012-11-15 2012-11-15 ## 22 01-701-1234 2013-03-30 2013-03-30 ## 23 01-701-1239 2014-01-11 2014-01-11 ## 24 01-701-1275 2014-02-07 2014-02-07 ## 25 01-701-1287 2014-01-25 2014-01-25 ## 26 01-701-1294 2013-03-24 2013-03-24 ## 27 01-701-1302 2013-08-29 2013-08-29 ## 28 01-701-1317 2014-05-22 2014-05-22 ## 29 01-701-1324 2012-10-02 2012-10-02 ## 30 01-701-1341 2013-01-05 2013-01-05 ## 31 01-701-1345 2013-10-08 2013-10-08 ## 32 01-701-1360 2013-07-31 2013-07-31 ## 33 01-701-1363 2013-05-30 2013-05-30 ## 34 01-701-1383 2013-02-04 2013-02-04 ## 35 01-701-1387 2014-03-12 2014-03-12 ## 36 01-701-1392 2012-10-28 2012-10-28 ## 37 01-701-1415 2013-09-23 2013-09-23 ## 38 01-701-1429 2013-03-19 2013-03-19 ## 39 01-701-1440 2013-08-08 2013-08-08 ## 40 01-701-1442 2013-10-26 2013-10-26 ## 41 01-701-1444 2013-01-05 2013-01-05 ## 42 01-702-1082 2013-07-26 2013-07-26 ## 43 01-703-1042 2013-03-02 2013-03-02 ## 44 01-703-1076 2013-10-25 2013-10-25 ## 45 01-703-1086 2012-09-02 2012-09-02 ## 46 01-703-1096 2013-01-25 2013-01-25 ## 47 01-703-1100 2013-03-13 2013-03-13 ## 48 01-703-1119 2013-02-20 2013-02-20 ## 49 01-703-1175 2013-12-20 2013-12-20 ## 50 01-703-1182 2013-10-17 2013-10-17 ## 51 01-703-1197 2013-06-16 2013-06-16 ## 52 01-703-1210 2013-03-16 2013-03-16 ## 53 01-703-1258 2012-07-20 2012-07-20 ## 54 01-703-1279 2013-05-13 2013-05-13 ## 55 01-703-1295 2013-11-21 2013-11-21 ## 56 01-703-1299 2012-09-12 2012-09-12 ## 57 01-703-1335 2014-03-17 2014-03-17 ## 58 01-703-1379 2013-09-22 2013-09-22 ## 59 01-703-1403 2012-12-12 2012-12-12 ## 60 01-703-1439 2014-03-12 2014-03-12 ## 61 01-704-1008 2013-01-13 2013-01-13 ## 62 01-704-1009 2013-08-27 2013-08-27 ## 63 01-704-1010 2014-02-21 2014-02-21 ## 64 01-704-1017 2013-10-06 2013-10-06 ## 65 01-704-1025 2013-09-27 2013-09-27 ## 66 01-704-1065 2013-10-24 2013-10-24 ## 67 01-704-1074 2014-01-22 2014-01-22 ## 68 01-704-1093 2013-03-15 2013-03-15 ## 69 01-704-1114 2013-01-23 2013-01-23 ## 70 01-704-1120 2013-12-02 2013-12-02 ## 71 01-704-1127 2013-10-02 2013-10-02 ## 72 01-704-1135 2013-10-31 2013-10-31 ## 73 01-704-1164 2012-09-19 2012-09-19 ## 74 01-704-1218 2012-11-19 2012-11-19 ## 75 01-704-1233 2013-03-21 2013-03-21 ## 76 01-704-1241 2013-08-25 2013-08-25 ## 77 01-704-1260 2012-08-30 2012-08-30 ## 78 01-704-1266 2013-10-13 2013-10-13 ## 79 01-704-1323 2013-07-08 2013-07-08 ## 80 01-704-1325 2014-04-23 2014-04-23 ## 81 01-704-1332 2013-12-09 2013-12-09 ## 82 01-704-1351 2013-10-12 2013-10-12 ## 83 01-704-1388 2012-12-07 2012-12-07 ## 84 01-704-1435 2012-11-17 2012-11-17 ## 85 01-704-1445 2014-05-11 2014-05-11 ## 86 01-705-1018 2013-07-05 2013-07-05 ## 87 01-705-1031 2013-11-27 2013-11-27 ## 88 01-705-1059 2013-08-05 2013-08-05 ## 89 01-705-1186 2014-01-08 2014-01-08 ## 90 01-705-1199 2013-09-16 2013-09-16 ## 91 01-705-1280 2014-01-17 2014-01-17 ## 92 01-705-1281 2013-11-28 2013-11-28 ## 93 01-705-1282 2012-12-26 2012-12-26 ## 94 01-705-1292 2013-10-14 2013-10-14 ## 95 01-705-1303 2013-12-16 2013-12-16 ## 96 01-705-1310 2013-11-02 2013-11-02 ## 97 01-705-1349 2013-03-10 2013-03-10 ## 98 01-705-1377 2014-01-04 2014-01-04 ## 99 01-705-1382 2013-05-13 2013-05-13 ## 100 01-705-1393 2012-09-07 2012-09-07 ## 101 01-705-1431 2013-06-23 2013-06-23 ## 102 01-706-1041 2013-12-31 2013-12-31 ## 103 01-706-1049 2013-05-14 2013-05-14 ## 104 01-706-1384 2012-09-15 2012-09-15 ## 105 01-707-1037 2013-12-20 2013-12-20 ## 106 01-707-1206 2013-10-28 2013-10-28 ## 107 01-708-1019 2013-12-20 2013-12-20 ## 108 01-708-1032 2013-02-09 2013-02-09 ## 109 01-708-1084 2013-05-09 2013-05-09 ## 110 01-708-1087 2012-10-22 2012-10-22 ## 111 01-708-1158 2014-02-08 2014-02-08 ## 112 01-708-1171 2012-12-06 2012-12-06 ## 113 01-708-1178 2013-12-29 2013-12-29 ## 114 01-708-1213 2013-02-09 2013-02-09 ## 115 01-708-1216 2012-10-24 2012-10-24 ## 116 01-708-1236 2013-09-21 2013-09-21 ## 117 01-708-1253 2013-05-07 2013-05-07 ## 118 01-708-1272 2013-02-06 2013-02-06 ## 119 01-708-1286 2013-09-10 2013-09-10 ## 120 01-708-1296 2013-06-14 2013-06-14 ## 121 01-708-1297 2013-01-25 2013-01-25 ## 122 01-708-1316 2013-08-23 2013-08-23 ## 123 01-708-1336 2012-12-07 2012-12-07 ## 124 01-708-1342 2012-12-29 2012-12-29 ## 125 01-708-1347 2013-04-20 2013-04-20 ## 126 01-708-1348 2013-08-05 2013-08-05 ## 127 01-708-1353 2013-07-04 2013-07-04 ## 128 01-708-1372 2013-04-12 2013-04-12 ## 129 01-708-1378 2013-09-03 2013-09-03 ## 130 01-708-1406 2013-12-26 2013-12-26 ## 131 01-708-1428 2013-11-09 2013-11-09 ## 132 01-709-1001 2013-10-08 2013-10-08 ## 133 01-709-1007 2012-07-31 2012-07-31 ## 134 01-709-1020 2012-12-01 2012-12-01 ## 135 01-709-1029 2012-12-25 2012-12-25 ## 136 01-709-1081 2014-01-18 2014-01-18 ## 137 01-709-1088 2014-04-12 2014-04-12 ## 138 01-709-1099 2013-10-25 2013-10-25 ## 139 01-709-1102 2013-01-15 2013-01-15 ## 140 01-709-1168 2013-08-02 2013-08-02 ## 141 01-709-1217 2013-03-04 2013-03-04 ## 142 01-709-1238 2013-05-15 2013-05-15 ## 143 01-709-1259 2013-01-26 2013-01-26 ## 144 01-709-1285 2013-03-24 2013-03-24 ## 145 01-709-1301 2013-07-19 2013-07-19 ## 146 01-709-1306 2014-02-03 2014-02-03 ## 147 01-709-1309 2013-06-19 2013-06-19 ## 148 01-709-1312 2014-04-20 2014-04-20 ## 149 01-709-1326 2013-04-05 2013-04-05 ## 150 01-709-1329 2013-08-15 2013-08-15 ## 151 01-709-1339 2012-12-23 2012-12-23 ## 152 01-709-1424 2013-03-03 2013-03-03 ## 153 01-710-1002 2014-01-14 2014-01-14 ## 154 01-710-1006 2013-02-10 2013-02-10 ## 155 01-710-1021 2013-09-27 2013-09-27 ## 156 01-710-1027 2014-02-28 2014-02-28 ## 157 01-710-1045 2013-06-03 2013-06-03 ## 158 01-710-1053 2012-12-26 2012-12-26 ## 159 01-710-1060 2013-01-01 2013-01-01 ## 160 01-710-1070 2012-09-08 2012-09-08 ## 161 01-710-1077 2013-11-17 2013-11-17 ## 162 01-710-1078 2013-09-17 2013-09-17 ## 163 01-710-1083 2013-07-22 2013-07-22 ## 164 01-710-1137 2013-10-11 2013-10-11 ## 165 01-710-1142 2012-10-02 2012-10-02 ## 166 01-710-1154 2014-03-29 2014-03-29 ## 167 01-710-1166 2012-11-30 2012-11-30 ## 168 01-710-1183 2013-11-16 2013-11-16 ## 169 01-710-1187 2012-11-10 2012-11-10 ## 170 01-710-1235 2012-09-26 2012-09-26 ## 171 01-710-1249 2013-12-28 2013-12-28 ## 172 01-710-1264 2013-06-13 2013-06-13 ## 173 01-710-1270 2014-02-12 2014-02-12 ## 174 01-710-1271 2012-09-27 2012-09-27 ## 175 01-710-1278 2012-12-24 2012-12-24 ## 176 01-710-1300 2012-12-15 2012-12-15 ## 177 01-710-1314 2013-04-24 2013-04-24 ## 178 01-710-1315 2013-02-27 2013-02-27 ## 179 01-710-1354 2012-11-11 2012-11-11 ## 180 01-710-1358 2012-09-17 2012-09-17 ## 181 01-710-1368 2013-10-23 2013-10-23 ## 182 01-710-1385 2012-10-29 2012-10-29 ## 183 01-710-1408 2013-01-05 2013-01-05 ## 184 01-711-1012 2013-04-03 2013-04-03 ## 185 01-711-1036 2012-07-29 2012-07-29 ## 186 01-711-1143 2013-04-03 2013-04-03 ## 187 01-711-1433 2013-01-27 2013-01-27 ## 188 01-713-1043 2013-09-15 2013-09-15 ## 189 01-713-1073 2014-03-30 2014-03-30 ## 190 01-713-1106 2012-10-31 2012-10-31 ## 191 01-713-1141 2013-05-31 2013-05-31 ## 192 01-713-1179 2013-08-09 2013-08-09 ## 193 01-713-1209 2013-05-27 2013-05-27 ## 194 01-713-1256 2012-09-19 2012-09-19 ## 195 01-713-1269 2014-01-27 2014-01-27 ## 196 01-713-1448 2014-01-19 2014-01-19 ## 197 01-714-1035 2014-04-17 2014-04-17 ## 198 01-714-1068 2013-08-08 2013-08-08 ## 199 01-714-1195 2013-04-26 2013-04-26 ## 200 01-714-1288 2013-12-04 2013-12-04 ## 201 01-714-1375 2013-02-26 2013-02-26 ## 202 01-714-1425 2013-08-15 2013-08-15 ## 203 01-715-1085 2013-02-16 2013-02-16 ## 204 01-715-1107 2013-02-26 2013-02-26 ## 205 01-715-1155 2013-12-13 2013-12-13 ## 206 01-715-1207 2012-11-18 2012-11-18 ## 207 01-715-1319 2013-02-17 2013-02-17 ## 208 01-715-1321 2014-02-11 2014-02-11 ## 209 01-715-1397 2013-04-03 2013-04-03 ## 210 01-715-1405 2013-07-06 2013-07-06 ## 211 01-716-1024 2012-07-09 2012-07-09 ## 212 01-716-1026 2014-04-02 2014-04-02 ## 213 01-716-1030 2013-12-28 2013-12-28 ## 214 01-716-1044 2013-04-27 2013-04-27 ## 215 01-716-1063 2013-05-09 2013-05-09 ## 216 01-716-1071 2013-06-08 2013-06-08 ## 217 01-716-1094 2012-12-19 2012-12-19 ## 218 01-716-1103 2014-03-20 2014-03-20 ## 219 01-716-1108 2013-02-12 2013-02-12 ## 220 01-716-1151 2013-02-01 2013-02-01 ## 221 01-716-1157 2013-10-02 2013-10-02 ## 222 01-716-1160 2013-04-05 2013-04-05 ## 223 01-716-1167 2012-10-08 2012-10-08 ## 224 01-716-1177 2014-09-02 2014-09-02 ## 225 01-716-1189 2012-10-09 2012-10-09 ## 226 01-716-1229 2013-02-20 2013-02-20 ## 227 01-716-1298 2013-04-08 2013-04-08 ## 228 01-716-1308 2013-08-28 2013-08-28 ## 229 01-716-1311 2014-05-14 2014-05-14 ## 230 01-716-1364 2013-07-04 2013-07-04 ## 231 01-716-1373 2012-12-14 2012-12-14 ## 232 01-716-1418 2013-05-05 2013-05-05 ## 233 01-716-1441 2014-01-22 2014-01-22 ## 234 01-716-1447 2013-12-16 2013-12-16 ## 235 01-717-1004 2014-01-14 2014-01-14 ## 236 01-717-1109 2014-01-27 2014-01-27 ## 237 01-717-1174 2013-01-22 2013-01-22 ## 238 01-717-1201 2013-12-19 2013-12-19 ## 239 01-717-1344 2014-01-11 2014-01-11 ## 240 01-717-1357 2013-05-01 2013-05-01 ## 241 01-717-1446 2013-09-01 2013-09-01 ## 242 01-718-1066 2013-07-07 2013-07-07 ## 243 01-718-1079 2012-09-19 2012-09-19 ## 244 01-718-1101 2013-02-17 2013-02-17 ## 245 01-718-1139 2013-05-19 2013-05-19 ## 246 01-718-1150 2013-01-19 2013-01-19 ## 247 01-718-1170 2013-09-16 2013-09-16 ## 248 01-718-1172 2013-09-21 2013-09-21 ## 249 01-718-1250 2013-09-21 2013-09-21 ## 250 01-718-1254 2013-07-10 2013-07-10 ## 251 01-718-1328 2013-02-01 2013-02-01 ## 252 01-718-1355 2013-02-28 2013-02-28 ## 253 01-718-1371 2013-04-26 2013-04-26 ## 254 01-718-1427 2012-12-17 2012-12-17 # nature of usubjid is character and svstdtc is &lt;s3.labelled&gt; adsl_deri01 &lt;- inner_join(adsl_deri01, sv_visit3 , by = &quot;usubjid&quot;) adsl_deri02 &lt;- adsl_deri01 %&gt;% select (usubjid , trtsdt, svstdtc , actarmcd , sitegr1, siteid , trt01p, arm , trt01a , trt01pn ,trt01pn,ittfl,agegr1,age,agegr1n,race ,racen,sex,ethnic , rfstdtc , rfendtc , sex , ethnic , dthfl ) #adsl_deri02 7.3.2 Date of Last Exposure to Treatment (TRTEDT) The date of final dose (from the CRF) is EX.EXENDTC on the subjects last EX record. If the date of final dose is missing for the subject and the subject discontinued after visit 3, use the date of discontinuation as the date of last dose. Steps to arrive at logic Check for the subjects whose final dose date is missing Check if these subjects discontinued after visit 3 (Check if they have any records after the Visit 3 , this needs checked ) If they have not discontinued then use the SV date as date of last dose To find last.date use slice_tail , slice_max within by group or use Dplyr::first or last functions , compare it original dataset #Final dates check exendtc &lt;- ex %&gt;% mutate(usubjid = as.character(usubjid) , exendtc_orig = exendtc, exendtc = as.Date(as.character(exendtc)) ) %&gt;% select( usubjid ,visit , visitnum, exendtc , exendtc_orig ) ds_disp &lt;- ds %&gt;% filter ( dscat == &quot;DISPOSITION EVENT&quot; ) %&gt;% mutate (usubjid = as.character(usubjid)) %&gt;% select ( usubjid , dsstdtc) exendtc &lt;- inner_join(exendtc , ds_disp , by = &quot;usubjid&quot;) adsl_chk &lt;- select (adsl , usubjid , trtedt ) using the as.Date( as.character () ) is creating numerical dates and date formats are not Below Logic is how you conditionally create a new column trtedt based DSSTDTC and exendtc_orig # Subjects whose does dates are missing exendtc_1 &lt;- exendtc %&gt;% mutate ( flag = ifelse (exendtc %in% NA , &quot;N&quot; ,&quot;Y&quot; ) , trtedt = ifelse(flag == &quot;N&quot;, as.character(dsstdtc), ifelse (flag ==&quot;Y&quot; ,as.character(exendtc_orig) , NA )) ) %&gt;% filter (visitnum &gt;= 3 ) #Final dates check exendtc &lt;- ex %&gt;% mutate(usubjid = as.character(usubjid) , exendtc_orig = exendtc, exendtc = as.Date(as.character(exendtc)) ) %&gt;% select( usubjid ,visit , visitnum, exendtc , exendtc_orig ) exendtc &lt;- inner_join(exendtc , sv_visit3 , by = &quot;usubjid&quot;) # Subjects whose does dates are missing exendtc &lt;- exendtc %&gt;% mutate ( flag = ifelse (exendtc %in% NA , &quot;N&quot; ,&quot;Y&quot; ), trtedt_c = ifelse(exendtc %in% NA , svstdtc , exendtc_orig ) , trtedt = as.Date(as.character(trtedt_c)) , trtedt_n = as.numeric(ifelse(exendtc %in% NA ,trtsdt , exendtc ) ) #, trtedt_ndt = as.Date.numeric (trtedt_n) ) %&gt;% filter (visitnum &gt;= 3 ) # One of the ways to get the First and Last group by values # Make sure you use the right variables used group_by exend &lt;- exendtc %&gt;% group_by (usubjid) %&gt;% dplyr:: mutate( first = dplyr::first(exendtc) , last = dplyr::last (exendtc) ) %&gt;% summarise(trtedt = last(exendtc)) ## `summarise()` ungrouping output (override with `.groups` argument) #exendtc &lt;- select(exendtc,usubjid ,visitnum , trtedt, trtedt_c ) "],["methods.html", "8 Methods", " 8 Methods We describe our methods in this chapter. "],["applications.html", "9 Applications 9.1 Example one 9.2 Example two", " 9 Applications Some significant applications are demonstrated in this chapter. 9.1 Example one 9.2 Example two "],["final-words.html", "10 Final Words", " 10 Final Words We have finished a nice book. "],["references.html", "References", " References "]]
